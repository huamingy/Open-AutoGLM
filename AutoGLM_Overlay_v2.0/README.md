# 🤖 AutoGLM Overlay v2.0 - AI 助手悬浮窗应用

## 📦 版本信息

- **版本号**: v2.0 (已签名)
- **构建时间**: 2025-12-13
- **文件大小**: 2.1MB
- **签名状态**: ✅ 已签名 (可直接安装)
- **支持系统**: Android 5.0+ (API 21+)

## 🚀 新功能特性

### ✅ v2.0 新增功能

1. **🌐 内置 Web 界面**

   - 完整的 AI 助手 Web 界面内置在应用中
   - 无需外部浏览器，直接在手机上操作
   - 美观的现代化 UI 设计

2. **📱 双模式启动**

   - **Web 界面模式**: 推荐使用，功能完整
   - **传统模式**: 兼容旧版使用方式

3. **🔄 实时同步**

   - Web 界面消息自动显示在悬浮窗
   - 双向通信，操作更流畅

4. **⚡ 智能连接**
   - 自动连接 WebSocket 服务器
   - 连接状态实时显示
   - 自动重连机制

## 🔧 调试功能

### 🐛 调试模式

应用主界面新增"🔧 调试工具"按钮，提供以下功能：

#### 🌐 连接测试

- HTTP 连接测试：验证服务器基本连通性
- WebSocket 端口测试：检查 8002 端口可访问性
- 自动诊断网络问题

#### 📊 实时日志

- 详细的连接状态日志
- 错误信息和诊断信息
- 时间戳记录所有操作

#### ⚙️ 自定义配置

- 可自定义服务器地址和端口
- 支持测试不同的服务器配置
- 实时验证连接参数

#### 🔍 开发者工具

- WebView 开发者选项已启用
- Chrome DevTools 调试支持
- 完整的 JavaScript 控制台日志

#### 🔄 自动连接和重连

- 页面加载后自动连接 WebSocket
- 连接断开后 3 秒自动重连
- 每 30 秒定期检查连接状态
- 连接错误时自动重连
- 多重保障确保连接稳定

#### 💓 心跳包机制

- 连接成功后自动启动心跳包
- 每 30 秒发送一次心跳消息
- 心跳超时 10 秒自动重连
- 服务器响应心跳包保持连接
- 实时检测网络连接状态

### 📋 调试使用方法

1. 打开应用，选择"🔧 调试工具"
2. 输入服务器地址(192.168.2.12)和端口(8002)
3. 点击"🌐 测试连接"验证 HTTP 连接
4. 点击"🔌 测试 WebSocket"验证 WebSocket 连接
5. 查看日志了解详细的连接状态

## 📱 快速开始

### 1. 安装应用

```bash
# 方法1: ADB安装
adb install -r android_overlay_app-release-unsigned.apk

# 方法2: 手动安装
# 将APK文件复制到手机，点击安装
```

### 2. 设置权限

#### 无障碍服务权限

```
设置 → 无障碍 → AutoGLM Overlay → 开启
```

#### 悬浮窗权限

```
设置 → 应用 → AutoGLM Overlay → 显示在其他应用上层 → 允许
```

### 3. 启动服务器

在云服务器(192.168.2.12)上启动 Python 服务器：

```bash
# 在云服务器192.168.2.12上运行
python ws.py
```

### 4. 使用应用

1. **打开应用**
2. **选择"🌐 打开 Web 界面"**
3. **在手机上直接输入 AI 指令**
4. **观察悬浮窗显示执行状态**

## 🎯 使用场景

### 📱 移动端完整体验

- 完全在手机端操作 AI 助手
- 实时悬浮窗显示操作进度
- 无需电脑辅助

### 🔄 混合使用模式

- Web 界面输入复杂指令
- 悬浮窗显示执行反馈
- 双重保障确保操作成功

### 🚀 演示展示

- 专业级的移动端 AI 演示
- 完整的功能展示
- 用户友好的界面设计

## 📋 功能说明

### 主界面功能

```
🤖 AutoGLM AI助手
├── 🌐 打开Web界面    # 推荐模式
├── 🚀 直接启动服务    # 传统模式
└── ⚙️ 无障碍设置      # 权限设置
```

### Web 界面功能

```
📝 任务指令输入
🚀 执行指令按钮
⏹️ 终止任务按钮
📡 连接状态显示
📄 实时消息日志
```

### 悬浮窗功能

```
🤖 AI状态显示
📄 实时操作反馈
⏹️ 一键终止按钮
```

## 🔧 技术规格

### 系统要求

- **Android 版本**: 5.0+ (API 21)
- **RAM**: 至少 512MB 可用内存
- **存储**: 50MB 可用空间

### 网络要求

- **WebSocket**: 端口 8002
- **协议**: WS/WSS
- **连接**: 本地网络

### 权限清单

```xml
<!-- 无障碍服务 -->
android.permission.BIND_ACCESSIBILITY_SERVICE

<!-- 悬浮窗显示 -->
android.permission.SYSTEM_ALERT_WINDOW

<!-- 网络连接 -->
android.permission.INTERNET
android.permission.ACCESS_NETWORK_STATE
```

## 🐛 故障排除

### 应用无法安装

```
错误: "应用未安装"
解决: 启用"未知来源"安装
```

### 无障碍服务无法开启

```
错误: "服务无法启动"
解决: 重启手机后重新开启
```

### Web 界面无法连接

```
错误: "WebSocket连接失败"
快速诊断: 运行 verify.bat
详细解决: 查看 TROUBLESHOOTING.md
基本检查:
1. 确认服务器运行: python ws.py (在192.168.2.12上)
2. 确认端口开放: 8002
3. 检查网络连接: simple_diagnose.bat
4. 确认消息格式: 已修复为JSON格式
```

### 悬浮窗不显示

```
错误: "悬浮窗权限被拒绝"
解决:
1. 应用设置 → 显示在其他应用上层
2. 重启应用
```

### 消息不同步

```
错误: "Web界面和悬浮窗消息不一致"
解决:
1. 确保无障碍服务正常运行
2. 重启应用重新连接
```

## 📞 技术支持

### 日志查看

```bash
# Android日志
adb logcat | grep AutoGLM

# 服务器日志
python ws.py  # 查看控制台输出
```

### 常见问题

1. **Q: 为什么 Web 界面加载慢？**

   - A: WebView 首次加载需要时间，后续会更快

2. **Q: 能否在没有电脑的情况下使用？**

   - A: 可以，但需要运行 WebSocket 服务器

3. **Q: 支持哪些 AI 指令？**
   - A: 支持所有 AutoGLM 定义的手机操作指令

## 🔄 更新日志

### v2.0 (2025-12-13)

- ✨ **新增**: 内置 Web 界面功能
- ✨ **新增**: 双模式启动界面
- ✨ **新增**: 实时消息同步
- ✨ **优化**: 用户界面设计
- ✨ **优化**: 网络连接稳定性
- 🔧 **修复**: 悬浮窗显示问题

### v1.0

- 🎯 基础悬浮窗功能
- 🔌 WebSocket 通信
- 📱 无障碍服务支持

## 📄 许可证

本项目采用 MIT 许可证开源协议。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

## 🎉 享受 AI 助手的新体验！

**现在就开始使用您的智能 AI 助手吧！** 🚀📱🤖

如有问题，请查看故障排除部分或提交 Issue。
